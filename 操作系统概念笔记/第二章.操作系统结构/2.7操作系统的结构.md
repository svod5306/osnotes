## 2.7操作系统的结构

操作系统的结构要基于软件工程的思路去设计

### 2.7.1简单结构

单片结构操作系统又称单体结构操作系统。

单体操作系统是一个非常基础的操作系统，其中文件管理、内存管理、设备管理和进程管理直接在内核中进行控制。内核可以访问系统中存在的所有资源。在单体系统中，操作系统的每个组件都包含在内核中。使用单体架构的操作系统在。

单体结构的优势是：由于直接调用系统服务，执行速度更快。内核通信开销小，速度快。

缺点：

1）添加新功能或删除过时功能非常困难。
2）安全问题总是存在的，因为内核中存在的各种服务器之间没有隔离。

比如以前的Linux系统，如果你的硬件驱动没有包含在内核之中，就需要下载驱动和内核的源代码，重新编译一个包含驱动的新内核。很不方便。早期的windows95,98等，也是单片操作系统。

很多人称单体结构的操作系统是宏内核操作系统。因为内核太大，保罗万象。

书上说Windows也是单片结构（还是用书上的称谓吧）操作系统。和很多人说的不一样，以书上为准。

### 2.7.2分层方法

是一种自顶向下设计，先确定总的功能和特征，载划分为功能模块的软件设计开发方法。也是软件工程的一种设计概念。

分层设计的优缺点不难理解，详情看书上

### 2.7.3微内核

微内核技术就是从内核中去除所有不必要的部件。去掉的那些部件，当作系统级或者用户级程序来实现。客户程序和具体服务的通信，通过微内核消息传递实现。也就是客户程序和服务程序之间不会直接交互，要通过微内核作为中间媒介。

### 2.7.4模块

被作者认为是目前最佳的操作系统结构。既类似微内核（内核只包含核心模块），又类似分层系统。内核的其他模块可以在启动或者运行的时候，根据需要动态实现。现在的Linux，windows都是这种模式。

模块方式的内核也只有核心功能，但是模块之间可以直接通信，无需调用内核传递消息。

Linux可加载的内核主要是设备驱动程序（现在不需要编译进内核了）和文件系统（识别不同的文件系统格式）

### 2.7.5混合系统

看到这里才知道前面说了半天都太片面，现在的操作系统都是混合模式，也就是说，不是单一的微内核或者宏内核，而是综合使用了上面各种系统设计思路。

下面介绍了几种混合系统，没啥理论性东西，都是略微介绍。

Dtrace是看得最莫名其妙，胃痛嚼蜡的一节。工作学习都没有接触过，作者写的太空范，太抽象。

Dtrace(Dynamic Trace)动态追踪，原先是sun公司的开发人员在费尽心力排查操作系统一个很低级（愚蠢）的错误后，痛定思痛开发的一个工具，用于系统的追踪调试。现在也指一种技术，拥有这个功能的其他软件还有linux上的systemtap.
