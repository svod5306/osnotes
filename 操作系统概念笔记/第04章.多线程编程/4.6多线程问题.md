### 4.6.1系统调用fork和exec

作者讲述了如果线程内fork，系统是否为产生的新进程复制所有线程的问题，以及fork后如果exec的时机不同，是否有必要复制线程的问题

### 4.6.2信号问题

Unix，Linux下叫做信号(Signal)。Windows称为消息。
Linux下可以通过kill、raise、alarm、pause这些信号处理系统调用来实现。

信号是由用户、系统或者进程发送给目标进程的信息，以通知目标进程某个状态的改变或系统异常。
信号是事件发生时对进程的通知机制，有时也称之为软件中断，它是在软件层次上对中断机制的一种模拟，是一种异步通信的方式。
信号可以导致一个正在运行的进程被另一个正在运行的异步进程中断，转而处理某一个突发事件。
注意，信号只是用来通知某进程发生了什么事件，无法给进程传递任何数据

进程内部异常或者出错等原因，产生的信号是同步信号，这时候信号会发送到这个出错的进程。

异步信号是进程以外的事件产生的，啥时候会产生，不确定，因为发送信号的进程和接收信号的进程是异步运行的。

信号处理程序负责对接收的信号做出适当的处理。可以是缺省的信号处理程序（系统内核驱动、实现），也可以是用户定义的信号处理程序。从这一点上来看，有些像windows对消息的处理。比如点击windows窗口右上角，默认处理是关闭窗口，但是实际上我们可以改写对WM_CLOSE消息的处理，实现其他操作。

单线程程序，信号发给进程即可

多线程程序，信号传递分为四种情况：

![](../../assets/2022-10-19-12-34-54-image.png)

具体怎么传递还取决于信号的类型，书上有解释。

Windows的APC（异步过程调用）模拟信号支持，并且APC直接把信号传递给线程，而不是进程。

 至于windows APC和 windows窗口程序编程时候的消息处理之间的关系，网上找不到资料，有必要可以问老师。书上也没有对APC举例，可能怕说的越多，引申的越多，越麻烦。先让大家有个基本印象。

### 4.6.3线程撤销
